--TEST--
Bug 514864 - syntax coloring problem with nested nowdoc and heredoc sections
--FILE--
<?php
<<<DOC
{$a(<<<'NESTED'
        $a
        {$a(<<<NESTED
        $a
        NESTED
    )}
    NESTED $a do
    )}
    $a
    DOC;
DOC;

<<<NESTED
    DOC;
    $a
    NESTED;

<<<'NESTED'
    $a
    {$a(<<<NESTED
    $a
    NESTED;
?>
--EXPECT--
PHP_TOKEN|<|2
PHP_TOKEN|?|2
PHP_LABEL|php|2
WHITESPACE|
|2
PHP_HEREDOC_START_TAG|<<<DOC
|16
PHP_CURLY_OPEN|{|2
PHP_VARIABLE|$a|2
PHP_TOKEN|(|2
PHP_NOWDOC_START_TAG|<<<'NESTED'
|18
PHP_CONSTANT_ENCAPSED_STRING|        $a
        {$a(<<<NESTED
        $a|34
PHP_NOWDOC_CLOSE_TAG|
        NESTED|2
WHITESPACE|
    |2
PHP_TOKEN|)|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE|
    NESTED|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_VARIABLE|$a|10
PHP_ENCAPSED_AND_WHITESPACE| do
    )}
    |12
PHP_VARIABLE|$a|10
PHP_HEREDOC_CLOSE_TAG|
    DOC|2
PHP_SEMICOLON|;|2
WHITESPACE|
|2
PHP_LABEL|DOC|2
PHP_SEMICOLON|;|2
WHITESPACE|
|2
PHP_HEREDOC_START_TAG|<<<NESTED
|16
PHP_ENCAPSED_AND_WHITESPACE|    DOC|16
PHP_ENCAPSED_AND_WHITESPACE|;
    |12
PHP_VARIABLE|$a|10
PHP_HEREDOC_CLOSE_TAG|
    NESTED|2
PHP_SEMICOLON|;|2
WHITESPACE|
|2
PHP_NOWDOC_START_TAG|<<<'NESTED'
|18
PHP_CONSTANT_ENCAPSED_STRING|    $a
    {$a(<<<NESTED
    $a|34
PHP_NOWDOC_CLOSE_TAG|
    NESTED|2
PHP_SEMICOLON|;|2
WHITESPACE|
|2
PHP_CLOSETAG|?>|2
