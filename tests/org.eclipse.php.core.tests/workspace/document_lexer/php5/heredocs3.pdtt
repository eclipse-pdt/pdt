--TEST--
Bug 514864 - syntax coloring problem with nested nowdoc and heredoc sections
--FILE--
<?php
<<<EOS
{$a(<<<NESTED
    ${a[$a[]]} {$a[$a[$a[$a[]]]]} ${a} ${a[0]}
NESTED
)}
${a[$a[]]} {$a[$a[$a[$a[]]]]} ${a} ${a[0]}
EOS;

$a(<<<NESTED
    ${a[$a[]]} {$a[$a[$a[$a[]]]]} ${a} ${a[0]}
NESTED
);

$a(<<<EOS
{$a(<<<NESTED
    ${a[$a[]]} {$a[$a[$a[$a[]]]]} ${a} ${a[0]}
NESTED
)}
${a[$a[]]} {$a[$a[$a[$a[]]]]} ${a} ${a[0]}
EOS
);

$a = 5;
?>
--EXPECT--
PHP_TOKEN|<|2
PHP_TOKEN|?|2
PHP_LABEL|php|2
WHITESPACE|
|2
PHP_HEREDOC_START_TAG|<<<EOS
|14
PHP_CURLY_OPEN|{|2
PHP_VARIABLE|$a|2
PHP_TOKEN|(|2
PHP_HEREDOC_START_TAG|<<<NESTED
|14
PHP_ENCAPSED_AND_WHITESPACE|    |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_CURLY_OPEN|{|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_TOKEN|[|2
PHP_NUMBER|0|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_HEREDOC_CLOSE_TAG|
NESTED|2
WHITESPACE|
|2
PHP_TOKEN|)|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE|
|12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_CURLY_OPEN|{|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_TOKEN|[|2
PHP_NUMBER|0|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_HEREDOC_CLOSE_TAG|
EOS;|2
WHITESPACE|
|2
PHP_VARIABLE|$a|2
PHP_TOKEN|(|2
PHP_HEREDOC_START_TAG|<<<NESTED
|14
PHP_ENCAPSED_AND_WHITESPACE|    |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_CURLY_OPEN|{|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_TOKEN|[|2
PHP_NUMBER|0|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_HEREDOC_CLOSE_TAG|
NESTED|2
WHITESPACE|
|2
PHP_TOKEN|)|2
PHP_SEMICOLON|;|2
WHITESPACE|
|2
PHP_VARIABLE|$a|2
PHP_TOKEN|(|2
PHP_HEREDOC_START_TAG|<<<EOS
|14
PHP_CURLY_OPEN|{|2
PHP_VARIABLE|$a|2
PHP_TOKEN|(|2
PHP_HEREDOC_START_TAG|<<<NESTED
|14
PHP_ENCAPSED_AND_WHITESPACE|    |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_CURLY_OPEN|{|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_TOKEN|[|2
PHP_NUMBER|0|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_HEREDOC_CLOSE_TAG|
NESTED|2
WHITESPACE|
|2
PHP_TOKEN|)|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE|
|12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_CURLY_OPEN|{|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_VARIABLE|$a|2
PHP_TOKEN|[|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_CURLY_CLOSE|}|12
PHP_ENCAPSED_AND_WHITESPACE| |12
PHP_TOKEN|$|30
PHP_CURLY_OPEN|{|30
PHP_ENCAPSED_VARIABLE|a|2
PHP_TOKEN|[|2
PHP_NUMBER|0|2
PHP_TOKEN|]|2
PHP_CURLY_CLOSE|}|12
PHP_HEREDOC_CLOSE_TAG|
EOS|2
WHITESPACE|
|2
PHP_TOKEN|)|2
PHP_SEMICOLON|;|2
WHITESPACE|
|2
PHP_VARIABLE|$a|2
WHITESPACE| |2
PHP_TOKEN|=|2
WHITESPACE| |2
PHP_NUMBER|5|2
PHP_SEMICOLON|;|2
WHITESPACE|
|2
PHP_CLOSETAG|?>|2
